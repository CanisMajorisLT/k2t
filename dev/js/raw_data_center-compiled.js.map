{"version":3,"sources":["raw_data_center.js"],"names":[],"mappings":"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","file":"raw_data_center-compiled.js","sourcesContent":["class RawDataCenter {\r\n\t// jeigu sitas oaimtu container object ir paduotu ji i recorder ir tas objectas turetu\r\n\t// query mechanizmus, tai tiesiog ji grazinu su query\r\n\tconstructor(recorder, container) {\r\n\t\tthis._container = new container();\r\n\t\tthis._recorder = new recorder(StatsObj, this._container);\r\n\t\tthis.queryData = this._container.query();\r\n\t}\r\n\r\n\trecord(inputResult, textData) {\r\n\t\t// basically same as calling recordStatics\r\n\t\treturn this._recorder.recordStatistic(inputResult, textData);\r\n\t}\r\n}\r\n\r\n\r\nclass RawDataRecorder {\r\n\tconstructor(StatsObj, container, backupOnLocalStorage = true) {\r\n\t\tthis.StatsObj = StatsObj;\r\n\t\tthis.statsObjectsContainer = container; \r\n\t\tthis.backupOnLocalStorage = backupOnLocalStorage;\r\n\t}\r\n\r\n\tgetStatsObj(textData) {\r\n\t\tlet statsObj = this.statsObjectsContainer.getItem(textData.gameId);\r\n\t\tif (statsObj) {\r\n\t\t\treturn statsObj\r\n\t\t} else {\r\n\t\t\tlet stats = new this.StatsObj(textData);\r\n\t\t\tthis.statsObjectsContainer.setItem(textData.gameId, stats);\r\n\t\t\treturn stats\r\n\t\t}\r\n\r\n\t}\r\n\r\n\trecordStatistic(inputResult, textData) {\r\n\t\tlet statsObj = this.getStatsObj(textData);\r\n\t\tlet oneWordStatCont = statsObj.wordStats[textData.currentWord];\r\n\t\tlet wordStats;\r\n\t\tif (oneWordStatCont !== undefined) {\r\n\t\t\twordStats = oneWordStatCont\r\n\t\t} else {\r\n\t\t\tstatsObj.wordStats[textData.currentWord] = [];\r\n\t\t\twordStats = statsObj.wordStats[textData.currentWord]\r\n\t\t}\r\n\t\twordStats.push(inputResult);\r\n\r\n\t\tif (textData.currentWord + 1 === textData.lengthInWords) {\r\n\t\t\tstatsObj.endTime = Date.now();\r\n\r\n\t\t\tif (this.backupOnLocalStorage === true) {\r\n\t\t\t\twindow.localStorage.setItem(textData.gameId, JSON.stringify(statsObj))\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// cia reikai pastetuoti nes is idejos jo nereiketu, kadangi grazi getItem ne kopija o linka i obj\r\n\t\tthis.statsObjectsContainer.setItem(textData.gameId, statsObj);\r\n\t};\r\n}\r\n\r\nclass StatsObj {\r\n\tconstructor(textData) {\r\n\t\tthis.gameId = textData.gameId;\r\n\t\tthis.textLengthInWords = textData.lengthInWords;\r\n\t\tthis.startTime = Date.now();\r\n\t\tthis.endTime = null;\r\n\t\tthis.wordStats = []\r\n\r\n\t}\r\n}\r\n\r\nclass StatsObjectsContainer {\r\n\tconstructor() {\r\n\t\tthis.container = {};\r\n\t\tinitialContainerFill()\r\n\t}\r\n\r\n\tinitialContainerFill(){\r\n\t\tObject.keys(localStorage).forEach((key)=>{\r\n\t\t\tthis.container[key] = JSON.parse(localStorage[key])\r\n\t\t})\r\n\t}\r\n\r\n\tgetItem(itemId) {\r\n\t\tif (this.container.hasOwnProperty(itemId)) {\r\n\t\t\treturn this.container[itemId]\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn null\r\n\t\t}\r\n\t}\r\n\tsetItem(itemId, item){\r\n\t\tthis.container[itemId] = item;\r\n\t}\r\n\r\n\t/*For when you want to get raw data for other use than live recording of it */\r\n\tquery() {\r\n\t\treturn {\r\n\t\t\tbyId: (itemId) => {return Object.assign({}, this.container[itemId])},\r\n\t\t\tall: () => {return Object.assign({}, this.container)}\r\n\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports = function initiateDataCenter () {\r\n\treturn new RawDataCenter(RawDataRecorder, StatsObjectsContainer)\r\n};\r\n"]}