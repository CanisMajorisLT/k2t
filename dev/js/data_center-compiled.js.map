{"version":3,"sources":["data_center.js"],"names":[],"mappings":"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","file":"data_center-compiled.js","sourcesContent":["/**\r\n * Created by vyt on 2015-09-03.\r\n */\r\nlet TextDataCenter = require(\"./text_data_center\");\r\nlet LearningDataCenter = require(\"./learning_data_center\");\r\nlet RawDataCenter = require(\"./raw_data_center\")();\r\nlet statistics = require(\"../js/statistics/comprehensive_statistics\");\r\nlet gameSpecificsStats = statistics.gameSpecificsStats;\r\nlet textSpecificStats = statistics.textSpecificStats;\r\nlet wordsSpecificStats = statistics.wordsSpecificStats;\r\nlet overAllStats = statistics.overAllStats;\r\n\r\n/*\r\n * - sends out data to subscribers when data is updated;\r\n * - sends data on request (by some query); */\r\nmodule.exports = class DataCenter {\r\n    constructor(rawData=RawDataCenter) {\r\n        // sources\r\n        this.sc = {\r\n            GAME_SPECIFIC: 'dataGameSpecific',\r\n            TEXTS_SPECIFIC: 'dataTextSpecific',\r\n            WORDS_SPECIFIC: 'dataWordsSpecific',\r\n            OVER_ALL: 'overAll'\r\n        };\r\n\r\n        this.subscribers = [];\r\n        this._data = this.getStatsFromLocalStorage(this.sc.TEXTS_SPECIFIC, this.sc.WORDS_SPECIFIC, this.sc.OVER_ALL); // paimam kol kas i localstorago ir praranimas fjas\r\n        this.rawData = RawDataCenter;\r\n        this.learningData = LearningDataCenter;\r\n        this.textDataCenter = TextDataCenter\r\n    }\r\n\r\n    getAllState() {\r\n        return Object.assign({}, this._data)\r\n    } \r\n\r\n    getData(...dataSources) {\r\n        let dataToReturn = dataSources.map((src)=> {\r\n            return {[src]: this._data[src]}\r\n        });\r\n        return Object.assign({}, ...dataToReturn)\r\n    }\r\n\r\n    updateData(...targets) {\r\n        console.log(\"data center updating data for\", ...targets);\r\n        this._data = this.getStatsFromLocalStorage(...targets);\r\n        this.__updateSubscribers();\r\n        console.log(\"data now is\", this._data)\r\n\r\n    }\r\n\r\n    __updateSubscribers() {\r\n        this.subscribers.forEach((subObj)=> {\r\n            let dataToReturn = subObj.dataSources.map(src=> this._data[src]);\r\n            return subObj.callback(Object.assign({}, ...dataToReturn))\r\n        })\r\n    }\r\n\r\n    // {callback: fnc, dataSources: [this.dataTextSpecific, this.dataWordsSpecific, this.overAll]}\r\n    subscribe(subObj) {\r\n        this.subscribers.push(subObj)\r\n    }\r\n\r\n    unsubscribe(subObj) {\r\n        let subIndex = this.subscribers.indexOf(subObj);\r\n        this.subscribers.splice(subIndex, 1)\r\n    }\r\n\r\n\r\n    getStatsFromLocalStorage(...targets) {\r\n        // this is required for other stat functions to work\r\n        let dataGameSpecific = gameSpecificsStats(this.rawData.queryData.all());\r\n\r\n        let dataTextSpecific = targets.indexOf(\"dataTextSpecific\") >= 0 && textSpecificStats(dataGameSpecific) || this._data[\"dataTextSpecific\"];\r\n        let dataWordsSpecific = targets.indexOf(\"dataWordsSpecific\") >= 0 && wordsSpecificStats(dataGameSpecific) || this._data[\"dataWordsSpecific\"];\r\n        let overAll = targets.indexOf(\"overAll\") >= 0 && overAllStats(dataGameSpecific) || this._data[\"overAll\"];\r\n        return {\r\n            dataGameSpecific,\r\n            dataTextSpecific,\r\n            dataWordsSpecific,\r\n            overAll\r\n        }\r\n    }\r\n}\r\n\r\n"]}